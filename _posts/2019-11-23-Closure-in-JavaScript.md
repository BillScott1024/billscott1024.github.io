---
layout: post
title: JavaScriptæ·±å…¥æµ…å‡ºä¹‹ç†è§£é—­åŒ…
date: 2019-11-23
tags: JavaScript
music-id: 829845
---

*  ç›®å½•
{:toc}

-------

![](https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/d3254348-13a1-4d50-af7d-393051ee62c2.jpg)

-------
# å‰è¨€

> å‡½æ•°ä¸å¯¹å…¶çŠ¶æ€å³è¯æ³•ç¯å¢ƒï¼ˆlexical environmentï¼‰çš„å¼•ç”¨å…±åŒæ„æˆé—­åŒ…ï¼ˆclosureï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé—­åŒ…
> å¯ä»¥è®©ä½ ä»å†…éƒ¨å‡½æ•°è®¿é—®å¤–éƒ¨å‡½æ•°ä½œç”¨åŸŸã€‚åœ¨JavaScriptï¼Œå‡½æ•°åœ¨æ¯æ¬¡åˆ›å»ºæ—¶ç”Ÿæˆé—­åŒ…ã€‚
> --- MDN Web docs

# ä»€ä¹ˆæ˜¯â€œé—­åŒ…â€
åœ¨MDN JavaScriptå®˜æ–¹æ–‡æ¡£ä¸Šå¯¹**â€œé—­åŒ…â€**çš„æè¿°æ˜¯ï¼šå‡½æ•°ä¸å…¶çŠ¶æ€å³è¯æ³•ç¯å¢ƒçš„å¼•ç”¨ï¼Œå…±åŒæ„æˆ**é—­åŒ…**ã€‚ç”¨æ›´é€šä¿—çš„è¯æ¥è®²å°±æ˜¯ï¼šé—­åŒ…å°±æ˜¯èƒ½å¤Ÿè¯»å–å…¶ä»–å‡½æ•°å†…éƒ¨å˜é‡çš„å‡½æ•°ã€‚ç®€å•æ¥è¯´ï¼Œé—­åŒ…æ˜¯ä¸€ç§å‡½æ•°ï¼Œä¸€ç§å®šä¹‰åœ¨å‡½æ•°å†…éƒ¨çš„å‡½æ•°ã€‚æœ¬è´¨ä¸Šï¼Œé—­åŒ…å°±æ˜¯å°†å‡½æ•°å†…éƒ¨å’Œå¤–éƒ¨è¿æ¥åœ¨ä¸€èµ·çš„ä¸€åº§æ¡¥æ¢ã€‚
ä¾‹å­ğŸŒ°ï¼š


```js
function func1(){
    var number = 999;
    function func2(){
        console.log(number);
    }
    return func2();
}

var result = func1();
result();               // "999"
var function(){
}

```

å…¶ä¸­ func2å‡½æ•°ï¼Œå°±æ˜¯é—­åŒ…ã€‚

# é—­åŒ…çš„ä½œç”¨

1. åœ¨å¤–éƒ¨èƒ½å¤Ÿè¯»å–å‡½æ•°å†…éƒ¨çš„å˜é‡ã€‚
2. ä½¿å˜é‡çš„å€¼ä¸€ç›´å­˜åœ¨äºå†…å­˜å½“ä¸­ã€‚
3. ä½¿ç”¨é—­åŒ…æ¨¡æ‹Ÿç§æœ‰æ–¹æ³•ã€‚

ç¤ºä¾‹ä»£ç ï¼š


```js
function func1(){
    var number = 999;
    addFunc = function(){
        number += 1;
    }
    
    function func2(){
        console.log(number);
    }
    return func2;
}

var result = func1();
result();       // "999"
addFunc();
result();       //"1000"
```

# é—­åŒ…ä¼šäº§ç”Ÿçš„é—®é¢˜ï¼ˆæ³¨æ„äº‹é¡¹ï¼‰
1. ç”±äºé—­åŒ…ä¼šä½¿å¾—å‡½æ•°ä¸­çš„å˜é‡éƒ½è¢«ä¿å­˜åœ¨å†…å­˜ä¹‹ä¸­ï¼Œå³ä½¿å‡½æ•°å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œè¿™äº›å±€éƒ¨å˜é‡ä¹Ÿä¸ä¼šè¢«åƒåœ¾å›æ”¶å™¨è‡ªåŠ¨å›æ”¶ï¼Œæœ‰æŸäº›ç¯å¢ƒä¸‹å®¹æ˜“å¯¼è‡´å†…å­˜æ³„æ¼ã€‚æ­£ç¡®åšæ³•æ˜¯ï¼Œåœ¨é€€å‡ºå‡½æ•°ä¹‹å‰ï¼Œå°†ä¸ä½¿ç”¨çš„å˜é‡éƒ½åˆ é™¤æ¸…ç©ºã€‚
2. é—­åŒ…ä¼šæ”¹å˜å‡½æ•°çš„å€¼ï¼Œè€Œä¸åªæ˜¯æ”¹å˜å‡½æ•°å˜é‡çš„ä¸€ä¸ªå‰¯æœ¬ã€‚
3. å¾ªç¯é—­åŒ…é—®é¢˜ã€‚











# å¼•ç”¨
æœ¬æ–‡å‚è€ƒï¼š

> [å­¦ä¹ Javascripté—­åŒ…ï¼ˆClosureï¼‰](https://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html)
> [é—­åŒ…](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures)
> [ç”¨9ç§åŠæ³•è§£å†³ JS é—­åŒ…ç»å…¸é¢è¯•é¢˜](https://segmentfault.com/a/1190000003818163)