---
layout: post
title: åˆ†ç¦»æ­Œæ›²éŸ³é¢‘ä¸­çš„äººå£°å’ŒèƒŒæ™¯éŸ³ä¹
date: 2019-11-06
tags: å·¥å…·
music-id: 536622304
---

*  ç›®å½•
{:toc}

# ä»ä¸€é¦–æ­Œä¸­åˆ†ç¦»äººå£°å’ŒBGM(èƒŒæ™¯éŸ³ä¹)
> 6

![Spleeter](https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/spleeter_logo.png)

## ä»‹ç»

æƒ³è¦Kæ­Œå´è‹¦äºæ‰¾ä¸åˆ°å–œæ¬¢çš„éŸ³ä¹çš„çº¯BGMï¼Ÿæƒ³è¦å»é™¤æ­Œæ›²ä¸­çš„å„ç§ä¹å™¨çš„èƒŒæ™¯éŸ³ä¹ï¼Œæ¥ä¸ªæ¸…å”±ç‰ˆï¼Ÿä¸å¦‚è¯•è¯•è¿™ä¸ªå¼€æºé¡¹ç›®å§

æ¥è‡ªæ³•å›½çš„éŸ³ä¹æµåª’ä½“å…¬å¸ Deezer å¼€æºäº†ä¸€ä¸ªéŸ³è½¨åˆ†ç¦»è½¯ä»¶ spleeterï¼Œåªéœ€è¾“å…¥ä¸€æ®µå‘½ä»¤å°±å¯ä»¥å°†éŸ³ä¹çš„äººå£°å’Œå„ç§ä¹å™¨å£°åˆ†ç¦»ï¼Œæ”¯æŒ mp3ã€wavã€ogg ç­‰å¸¸è§éŸ³é¢‘æ ¼å¼ã€‚

è¿™æ¬¾è½¯ä»¶åŸºäº TensorFlow å¼€å‘ï¼Œæ•ˆæœæ‹”ç¾¤ï¼Œæœ‰ç½‘å‹è¯´è‡ªå·±æ›¾ç»è¯•è¿‡æ— æ•°ç±»ä¼¼è½¯ä»¶ï¼Œspleeter æ˜¯æœ€å¥½ç”¨çš„ä¸€ä¸ªã€‚

æˆ‘åœ¨é…ç½®å¥½ç¯å¢ƒåï¼Œæµ‹è¯•äº†ä¸€ä¸‹ï¼Œæ•ˆæœæ‹”ç¾¤ï¼Œå‡ ä¹æ˜¯æˆ‘ä½¿ç”¨è¿‡çš„æœ€å¥½çš„åˆ†ç¦»äººå£°å’Œæ¶ˆé™¤èƒŒæ™¯éŸ³çš„å·¥å…·ã€‚æˆ‘ä½¿ç”¨çš„æµ‹è¯•æ­Œæ›²æ˜¯ç±³æ´¥ç„å¸ˆçš„ã€ŠLemonã€‹

ç‚¹å‡»è“å­—æ’­æ”¾â†“
è½¬æ¢å‰ï¼š[åŸå£°](https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/audio/Lemon-%E7%B1%B3%E6%B4%A5%E7%8E%84%E5%B8%88.mp3)
è½¬æ¢åçš„äººå£°éƒ¨åˆ†ï¼š[äººå£°MP3](https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/audio/vocals.mp3)
è½¬æ¢åçš„èƒŒæ™¯éŸ³ä¹éƒ¨åˆ†ï¼š[èƒŒæ™¯éŸ³MP3](https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/audio/accompaniment.mp3)

è™½ç„¶ç½‘é¡µä¸Šçš„éŸ³é¢‘ç»è¿‡äº†å‹ç¼©ï¼ŒéŸ³è´¨ä¸å¤ªå¥½ï¼Œä½†æ˜¯å¯ä»¥å¾ˆæ˜æ˜¾çš„æ„Ÿå—åˆ°ï¼Œåˆ†ç¦»çš„æ•ˆæœæ˜¯éå¸¸æ˜æ˜¾çš„ï¼Œäººå£°çš„éŸ³é¢‘å‡ ä¹å¬ä¸åˆ°BGMäº†ï¼ŒBGMçš„éŸ³é¢‘ä¹Ÿåªèƒ½å¬åˆ°ä¸€ç‚¹ç‚¹çš„ä¸å’Œè°ã€‚

spleeter è¿˜æ”¯æŒ GPU åŠ é€Ÿã€‚å¦‚æœåœ¨ GPU ä¸Šè¿è¡Œï¼Œä¼šæ¯”å®æ—¶åˆ†è§£é€Ÿåº¦å¿« 100 å€ï¼Œä¹Ÿå°±æ˜¯è¯´åˆ†è§£ä¸€é¦– 5 åˆ†é’Ÿçš„æ­Œæ›²åªéœ€è¦ 3 ç§’ã€‚å³ä½¿æ˜¯ä½¿ç”¨CPUï¼Œåˆ†è§£è¿™æ ·ä¸€é¦–4åˆ†é’Ÿçš„éŸ³é¢‘ï¼Œä¹Ÿåªç”¨äº†ä¸åˆ°1åˆ†é’Ÿçš„æ—¶é—´ï¼Œä¸ªäººä½¿ç”¨ä¸Šæ¥è¯´è¿‡ç»å¯¹è¶³å¤Ÿäº†ã€‚

GitHubé¡¹ç›®åœ°å€ï¼š[Spleeteräººå£°åˆ†ç¦»](https://github.com/deezer/spleeter)

# ä½¿ç”¨æ–¹æ³•
## ç¯å¢ƒé…ç½®
**æ“ä½œç³»ç»Ÿ**ï¼š Mac OS / Windows / Linux
**Python**ï¼š Version3.7 / Version 2.7
**Conda**ï¼š Miniconda

## æ­¥éª¤
1. å®‰è£…Condaç¯å¢ƒ
2. ä»GitHubä¸ŠCloneé¡¹ç›®åˆ°æœ¬åœ°
3. ä½¿ç”¨Condaå‘½ä»¤è¿è¡ŒSpleeterå®Œæˆäººå£°éŸ³é¢‘åˆ†ç¦»


## è¯¦ç»†å®‰è£…æ­¥éª¤
> è¿™é‡Œåªä»¥MacOSä¸ºä¾‹ï¼ŒWindowsçš„æ­¥éª¤å¤§åŒå°å¼‚ï¼Œæœ‰é—®é¢˜å¯ä»¥ç•™è¨€ã€‚

1. åœ¨Condaçš„å®˜ç½‘ä¸Šä¸‹è½½è‡ªå·±è®¡ç®—æœºå¯¹åº”ç‰ˆæœ¬çš„Condaå®‰è£…ç¨‹åºï¼Œæˆ–è€…åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…ï¼ŒCondaå®˜ç½‘åœ°å€ç‚¹å‡»è¿™é‡Œ[Conda](https://docs.conda.io/en/latest/conda.html)ï¼Œæˆ–è€…ç‚¹å‡»è¿™é‡Œçš„ä¸‹è½½é¡µè¿›è¡Œä¸‹è½½ï¼š[Minicondaä¸‹è½½åœ°å€](https://docs.conda.io/en/latest/miniconda.html)

    å¦‚ä¸‹å›¾ï¼Œç‚¹å‡»è“å­—è¿›è¡Œä¸‹è½½ï¼Œ32ä½çš„ç³»ç»Ÿå°±ä¸‹è½½32ä½çš„ï¼Œ64ä½çš„å°±ä¸‹è½½64ä½çš„ï¼ŒMac OSç³»ç»Ÿçš„ç›´æ¥ä¸‹è½½.pkgæ–‡ä»¶å°±è¡Œã€‚ç”±äºæ˜¯å›½å¤–çš„å®˜ç½‘ï¼Œå¯èƒ½ä¸‹è½½ä¼šä¸­æ–­ï¼Œè€å¿ƒå¤šä¸‹è½½å‡ æ¬¡å³å¯ï¼Œæ˜¯åœ¨æ— æ³•ä¸‹è½½çš„å¯ä»¥åœ¨æœ¬æ–‡ä¸‹é¢ç•™è¨€é‚®ç®±åœ°å€ï¼Œæˆ‘çœ‹åˆ°ä¼šæŠŠå®‰è£…åŒ…å‘åˆ°ä½ çš„é‚®ç®±ğŸ“®é‡Œã€‚
![](https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20191106193236.png)

2. ä¸‹è½½å®Œæˆåï¼Œç‚¹å‡»å®‰è£…
![](https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20191106193303.png)
    å¦‚æœé‡åˆ°æœªä¿¡ä»»çš„ç¨‹åºï¼Œæ— æ³•å®‰è£…ï¼Œè¯·åˆ°ç³»ç»Ÿåå¥½è®¾ç½®->å®‰å…¨ä¸éšç§->å…è®¸ä»ä»¥ä¸‹ä½ç½®ä¸‹è½½åº”ç”¨å‹¾é€‰AppStoreå’Œè¢«è®¤å¯çš„å¼€å‘è€…
![](https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20191106193211.png)

1. å®‰è£…å®Œæˆåï¼Œæ‰“å¼€å‘½ä»¤è¡Œå·¥å…·iTermï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ï¼šconda -V,å¦‚æœè¾“å‡ºä¸æ˜¯command not foundï¼Œé‚£ä¹ˆCondaç¯å¢ƒå°±å®‰è£…æˆåŠŸäº†
![](https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20191106194445.png)

1. å¦‚æœæœ¬æœºæœ‰gitï¼Œé‚£ä¹ˆç›´æ¥è¾“å…¥
    `git clone https://github.com/deezer/spleeter`
    å…‹éš†gitä»“åº“åˆ°æœ¬åœ°ï¼Œæ²¡æœ‰å®‰è£…gitçš„è¯ç‚¹å‡»ï¼š[Spleeteräººå£°åˆ†ç¦»](https://github.com/deezer/spleeter)ï¼Œç‚¹å‡»DownloadZIPï¼Œä¸‹è½½åˆ°æœ¬åœ°
    ![](https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20191106194708.png)

5.è¿›å…¥é¡¹ç›®æ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œæ‰“å¼€å‘½ä»¤è¡Œï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥å‘½ä»¤ï¼š
    `conda env create -f spleeter/conda/spleeter-cpu.yaml`
    æŒ‰å›è½¦åï¼Œå†è¾“å…¥å‘½ä»¤
    `conda activate spleeter-cpu`
    

å¦‚æœæƒ³æ¢æˆ GPU ç¯å¢ƒï¼Œåªéœ€å°†ä¸Šè¿°ä»£ç ä¸­çš„ spleeter-cpu æ¢æˆ spleeter-gpuã€‚

æœ€åå†è¾“å…¥ï¼š
`spleeter separate -i audio_example.mp3 -o audio_output -p spleeter:4stems`

åœ¨åˆ†ç¦»éŸ³è½¨çš„å‘½ä»¤ä¸­ï¼ŒåŠ å…¥é€‰é¡¹ - p spleeter:4stems æ¥æŒ‡å®šéŸ³è½¨æ•°é‡ï¼Œå¦‚æœä¸åŠ ï¼Œç³»ç»Ÿé»˜è®¤åˆ†ç¦»ä¸º 2 ä¸ªéŸ³è½¨ã€‚

æœ€ç»ˆä¹å™¨å’Œäººå£°å°†ä»¥ wav æ–‡ä»¶çš„æ ¼å¼ä¿å­˜åœ¨ audio_output æ–‡ä»¶å¤¹ä¸­ã€‚
åˆ†ç¦»è¿‡ç¨‹å¯ä»¥åœ¨ GPU æˆ– CPU ä¸Šæ‰§è¡Œã€‚åœ¨ GPU ä¸Šè¿è¡Œï¼Œé€Ÿåº¦éå¸¸å¿«ï¼Œå¯ä»¥å®ç° 100 å€çš„åŠ é€Ÿã€‚
![](https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20191106195126.png)